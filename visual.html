<!doctype html><html><head><title>Movie Browser</title><style>/* 960.gs: reset.css */ html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outline:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}body { font: 14px/1.5 Georgia, 'Times New Roman', serif; }.moviebox { width: 10px; height: 10px; font-size: 8px; display: block; position: absolute; }.searching .moviebox { width: 2px; height: 2px; font-size: 2px; }.searching .found { width: 10px; height: 10px; font-size: 10px; }.popup { position:absolute; background-color: #ebf8de; z-index: 1000; margin: 0; padding: 6px; display: none;-webkit-border-radius: 3px;   -moz-border-radius: 3px;        border-radius: 3px;      -moz-box-shadow: 1px 1px 3px black;   -webkit-box-shadow: 1px 1px 3px black;           box-shadow: 1px 1px 3px black;}.popup a { color: #4f6228; }.popup .nomatch a { color: #bbe06a; }.popup td { padding: 0 3px; }.popup tr:nth-child(2n) { background-color: #fff; }{% if other_page %}.popup input { display:none; }{% endif %}.seen, .seen a { text-decoration: line-through; color: #9ab75c; }#plot { margin: 0 auto; position: relative; text-align: center; }.loading { margin: 5em auto; font-size: 150%; }#controls { display:block; margin: 10px auto 0 auto; text-align: center; }.slowly { display: none; }.no-hsla .slowly { display: block; }#less-rating, #more-rating { margin: 5px auto; text-align: center; }#less-votes { float:left; }#more-votes { float:right; }</style><script type="text/javascript">  var _gaq = _gaq || [];  _gaq.push(['_setAccount', 'UA-7269195-1']);  _gaq.push(['_trackPageview']);  {% if user %}_gaq.push(['_setCustomVar',1,"HasLoggedIn","Yes",1]);{% endif %}  (function() {    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);  })();</script></head><body><div id="controls"><input id="title" placeholder="search"><select id="genre"><option></option><option>Action</option><option>Adult</option><option>Adventure</option><option>Animation</option><option>Biography</option><option>Comedy</option><option>Crime</option><option>Documentary</option><option>Drama</option><option>Family</option><option>Fantasy</option><option>Film-Noir</option><option>Game-Show</option><option>History</option><option>Horror</option><option>Lifestyle</option><option>Music</option><option>Musical</option><option>Mystery</option><option>News</option><option>Reality-TV</option><option>Romance</option><option>Sci-Fi</option><option>Short</option><option>Sport</option><option>Talk-Show</option><option>Thriller</option><option>War</option><option>Western</option></select><div id="less-votes">&laquo; Fewer votes</div><div id="more-votes">More votes &raquo;</div></div><div id="less-rating">&#x25b2; Top rated</div><div id="plot"> <div class="loading">  Loading...  <br>  <span class="slowly">This will be SLOW in your browser. Try Firefox, Chrome or Safari</span>  <img src="/loading-small.gif"> </div></div><div id="more-rating">&#x25bc; Worst rated</div><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script><script>/* underscore.js */(function(){var p=this,C=p._,m={},j=Array.prototype,n=Object.prototype,i=j.slice,D=j.unshift,E=n.toString,q=n.hasOwnProperty,s=j.forEach,t=j.map,u=j.reduce,v=j.reduceRight,w=j.filter,x=j.every,y=j.some,o=j.indexOf,z=j.lastIndexOf;n=Array.isArray;var F=Object.keys,c=function(a){return new l(a)};if(typeof module!=="undefined"&&module.exports){module.exports=c;c._=c}else p._=c;c.VERSION="1.1.3";var k=c.each=c.forEach=function(a,b,d){if(s&&a.forEach===s)a.forEach(b,d);else if(c.isNumber(a.length))for(var e=0,f=a.length;e<f;e++){if(b.call(d,a[e],e,a)===m)break}else for(e in a)if(q.call(a,e))if(b.call(d,a[e],e,a)===m)break};c.map=function(a,b,d){if(t&&a.map===t)return a.map(b,d);var e=[];k(a,function(f,g,h){e[e.length]=b.call(d,f,g,h)});return e};c.reduce=c.foldl=c.inject=function(a,b,d,e){var f=d!==void 0;if(u&&a.reduce===u){if(e)b=c.bind(b,e);return f?a.reduce(b,d):a.reduce(b)}k(a,function(g,h,G){d=!f&&h===0?g:b.call(e,d,g,h,G)});return d};c.reduceRight=c.foldr=function(a,b,d,e){if(v&&a.reduceRight===v){if(e)b=c.bind(b,e);return d!==void 0?a.reduceRight(b,d):a.reduceRight(b)}a=(c.isArray(a)?a.slice():c.toArray(a)).reverse();return c.reduce(a,b,d,e)};c.find=c.detect=function(a,b,d){var e;A(a,function(f,g,h){if(b.call(d,f,g,h)){e=f;return true}});return e};c.filter=c.select=function(a,b,d){if(w&&a.filter===w)return a.filter(b,d);var e=[];k(a,function(f,g,h){if(b.call(d,f,g,h))e[e.length]=f});return e};c.reject=function(a,b,d){var e=[];k(a,function(f,g,h){b.call(d,f,g,h)||(e[e.length]=f)});return e};c.every=c.all=function(a,b,d){b=b||c.identity;if(x&&a.every===x)return a.every(b,d);var e=true;k(a,function(f,g,h){if(!(e=e&&b.call(d,f,g,h)))return m});return e};var A=c.some=c.any=function(a,b,d){b=b||c.identity;if(y&&a.some===y)return a.some(b,d);var e=false;k(a,function(f,g,h){if(e=b.call(d,f,g,h))return m});return e};c.include=c.contains=function(a,b){if(o&&a.indexOf===o)return a.indexOf(b)!=-1;var d=false;A(a,function(e){if(d=e===b)return true});return d};c.invoke=function(a,b){var d=i.call(arguments,2);return c.map(a,function(e){return(b?e[b]:e).apply(e,d)})};c.pluck=function(a,b){return c.map(a,function(d){return d[b]})};c.max=function(a,b,d){if(!b&&c.isArray(a))return Math.max.apply(Math,a);var e={computed:-Infinity};k(a,function(f,g,h){g=b?b.call(d,f,g,h):f;g>=e.computed&&(e={value:f,computed:g})});return e.value};c.min=function(a,b,d){if(!b&&c.isArray(a))return Math.min.apply(Math,a);var e={computed:Infinity};k(a,function(f,g,h){g=b?b.call(d,f,g,h):f;g<e.computed&&(e={value:f,computed:g})});return e.value};c.sortBy=function(a,b,d){return c.pluck(c.map(a,function(e,f,g){return{value:e,criteria:b.call(d,e,f,g)}}).sort(function(e,f){var g=e.criteria,h=f.criteria;return g<h?-1:g>h?1:0}),"value")};c.sortedIndex=function(a,b,d){d=d||c.identity;for(var e=0,f=a.length;e<f;){var g=e+f>>1;d(a[g])<d(b)?e=g+1:f=g}return e};c.toArray=function(a){if(!a)return[];if(a.toArray)return a.toArray();if(c.isArray(a))return a;if(c.isArguments(a))return i.call(a);return c.values(a)};c.size=function(a){return c.toArray(a).length};c.first=c.head=function(a,b,d){return b&&!d?i.call(a,0,b):a[0]};c.rest=c.tail=function(a,b,d){return i.call(a,c.isUndefined(b)||d?1:b)};c.last=function(a){return a[a.length-1]};c.compact=function(a){return c.filter(a,function(b){return!!b})};c.flatten=function(a){return c.reduce(a,function(b,d){if(c.isArray(d))return b.concat(c.flatten(d));b[b.length]=d;return b},[])};c.without=function(a){var b=i.call(arguments,1);return c.filter(a,function(d){return!c.include(b,d)})};c.uniq=c.unique=function(a,b){return c.reduce(a,function(d,e,f){if(0==f||(b===true?c.last(d)!=e:!c.include(d,e)))d[d.length]=e;return d},[])};c.intersect=function(a){var b=i.call(arguments,1);return c.filter(c.uniq(a),function(d){return c.every(b,function(e){return c.indexOf(e,d)>=0})})};c.zip=function(){for(var a=i.call(arguments),b=c.max(c.pluck(a,"length")),d=Array(b),e=0;e<b;e++)d[e]=c.pluck(a,""+e);return d};c.indexOf=function(a,b){if(o&&a.indexOf===o)return a.indexOf(b);for(var d=0,e=a.length;d<e;d++)if(a[d]===b)return d;return-1};c.lastIndexOf=function(a,b){if(z&&a.lastIndexOf===z)return a.lastIndexOf(b);for(var d=a.length;d--;)if(a[d]===b)return d;return-1};c.range=function(a,b,d){var e=i.call(arguments),f=e.length<=1;a=f?0:e[0];b=f?e[0]:e[1];d=e[2]||1;e=Math.max(Math.ceil((b-a)/d),0);f=0;for(var g=Array(e);f<e;){g[f++]=a;a+=d}return g};c.bind=function(a,b){var d=i.call(arguments,2);return function(){return a.apply(b||{},d.concat(i.call(arguments)))}};c.bindAll=function(a){var b=i.call(arguments,1);if(b.length==0)b=c.functions(a);k(b,function(d){a[d]=c.bind(a[d],a)});return a};c.memoize=function(a,b){var d={};b=b||c.identity;return function(){var e=b.apply(this,arguments);return e in d?d[e]:d[e]=a.apply(this,arguments)}};c.delay=function(a,b){var d=i.call(arguments,2);return setTimeout(function(){return a.apply(a,d)},b)};c.defer=function(a){return c.delay.apply(c,[a,1].concat(i.call(arguments,1)))};var B=function(a,b,d){var e;return function(){var f=this,g=arguments,h=function(){e=null;a.apply(f,g)};d&&clearTimeout(e);if(d||!e)e=setTimeout(h,b)}};c.throttle=function(a,b){return B(a,b,false)};c.debounce=function(a,b){return B(a,b,true)};c.wrap=function(a,b){return function(){var d=[a].concat(i.call(arguments));return b.apply(b,d)}};c.compose=function(){var a=i.call(arguments);return function(){for(var b=i.call(arguments),d=a.length-1;d>=0;d--)b=[a[d].apply(this,b)];return b[0]}};c.keys=F||function(a){if(c.isArray(a))return c.range(0,a.length);var b=[],d;for(d in a)if(q.call(a,d))b[b.length]=d;return b};c.values=function(a){return c.map(a,c.identity)};c.functions=c.methods=function(a){return c.filter(c.keys(a),function(b){return c.isFunction(a[b])}).sort()};c.extend=function(a){k(i.call(arguments,1),function(b){for(var d in b)a[d]=b[d]});return a};c.clone=function(a){return c.isArray(a)?a.slice():c.extend({},a)};c.tap=function(a,b){b(a);return a};c.isEqual=function(a,b){if(a===b)return true;var d=typeof a;if(d!=typeof b)return false;if(a==b)return true;if(!a&&b||a&&!b)return false;if(a.isEqual)return a.isEqual(b);if(c.isDate(a)&&c.isDate(b))return a.getTime()===b.getTime();if(c.isNaN(a)&&c.isNaN(b))return false;if(c.isRegExp(a)&&c.isRegExp(b))return a.source===b.source&&a.global===b.global&&a.ignoreCase===b.ignoreCase&&a.multiline===b.multiline;if(d!=="object")return false;if(a.length&&a.length!==b.length)return false;d=c.keys(a);var e=c.keys(b);if(d.length!=e.length)return false;for(var f in a)if(!(f in b)||!c.isEqual(a[f],b[f]))return false;return true};c.isEmpty=function(a){if(c.isArray(a)||c.isString(a))return a.length===0;for(var b in a)if(q.call(a,b))return false;return true};c.isElement=function(a){return!!(a&&a.nodeType==1)};c.isArray=n||function(a){return!!(a&&a.concat&&a.unshift&&!a.callee)};c.isArguments=function(a){return!!(a&&a.callee)};c.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)};c.isString=function(a){return!!(a===""||a&&a.charCodeAt&&a.substr)};c.isNumber=function(a){return!!(a===0||a&&a.toExponential&&a.toFixed)};c.isNaN=function(a){return E.call(a)==="[object Number]"&&isNaN(a)};c.isBoolean=function(a){return a===true||a===false};c.isDate=function(a){return!!(a&&a.getTimezoneOffset&&a.setUTCFullYear)};c.isRegExp=function(a){return!!(a&&a.test&&a.exec&&(a.ignoreCase||a.ignoreCase===false))};c.isNull=function(a){return a===null};c.isUndefined=function(a){return a===void 0};c.noConflict=function(){p._=C;return this};c.identity=function(a){return a};c.times=function(a,b,d){for(var e=0;e<a;e++)b.call(d,e)};c.mixin=function(a){k(c.functions(a),function(b){H(b,c[b]=a[b])})};var I=0;c.uniqueId=function(a){var b=I++;return a?a+b:b};c.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g};c.template=function(a,b){var d=c.templateSettings;d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(d.interpolate,function(e,f){return"',"+f.replace(/\\'/g,"'")+",'"}).replace(d.evaluate||null,function(e,f){return"');"+f.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";d=new Function("obj",d);return b?d(b):d};var l=function(a){this._wrapped=a};c.prototype=l.prototype;var r=function(a,b){return b?c(a).chain():a},H=function(a,b){l.prototype[a]=function(){var d=i.call(arguments);D.call(d,this._wrapped);return r(b.apply(c,d),this._chain)}};c.mixin(c);k(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=j[a];l.prototype[a]=function(){b.apply(this._wrapped,arguments);return r(this._wrapped,this._chain)}});k(["concat","join","slice"],function(a){var b=j[a];l.prototype[a]=function(){return r(b.apply(this._wrapped,arguments),this._chain)}});l.prototype.chain=function(){this._chain=true;return this};l.prototype.value=function(){return this._wrapped}})();/* http://js-tables.googlecode.com/svn/trunk/jquery.csv.min.js */(function(){function p(a){return function(c){return c.split(a)}}function q(a,c,f,i){return function(e){e=e.split(c);for(var g=[],d,b=0,h=e.length;b<h;b++)if(d=e[b].match(f)){d=d[0];for(var j=b;j<h;j++)if(e[j].charAt(e[j].length-1)==d)break;b=e.slice(b,j+1).join(a);b=b.replace(i[d],d);g.push(b.substr(1,b.length-2));b=j}else g.push(e[b]);return g}}function m(a,c,f){a=typeof a=="undefined"?",":a;c=typeof c=="undefined"?'"':c;f=typeof f=="undefined"?"\r\n":f;for(var i=c?c.split(""):[],e=RegExp("["+a+"]"),g=RegExp("^["+c+"]"),d=0,b={},h;h=i[d];d++)b[h]=RegExp(h+h,"g");return[RegExp("["+f+"]*$"),RegExp("["+f+"]["+f+"]*"),c?q(a,e,g,b):p(e)]}if("a,,b".split(",").length<3){var n=n||String.prototype.split;String.prototype.split=function(a,c){if(!(a instanceof RegExp))return n.apply(this,arguments);if(c===undefined||+c<0)c=false;else{c=Math.floor(+c);if(!c)return[]}var f=(a.global?"g":"")+(a.ignoreCase?"i":"")+(a.multiline?"m":""),i=RegExp("^"+a.source+"$",f),e=[],g=0,d=0,b;for(a.global||(a=RegExp(a.source,"g"+f));(!c||d++<=c)&&(b=a.exec(this));){if((f=!b[0].length)&&a.lastIndex>b.index)a.lastIndex=b.index;if(a.lastIndex>g){b.length>1&&b[0].replace(i,function(){for(var h=1;h<arguments.length-2;h++)if(arguments[h]===undefined)b[h]=undefined});e=e.concat(this.slice(g,b.index),b.index===this.length?[]:b.slice(1));g=a.lastIndex}f&&a.lastIndex++}return g===this.length?a.test("")?e:e.concat(""):c?e:e.concat(this.slice(g))}}jQuery.extend({csv:function(a,c,f){a=m(a,c,f);var i=a[0],e=a[1],g=a[2];return function(d){d=d.replace(i,"").split(e);for(var b=0,h=d.length;b<h;b++)d[b]=g(d[b]);return d}},csv2json:function(a,c,f){a=m(a,c,f);var i=a[0],e=a[1],g=a[2];return function(d){d=d.replace(i,"").split(e);for(var b=g(d[0]),h=b.length,j=[],l=1,r=d.length;l<r;l++){for(var s=g(d[l]),k=0,o={};k<h;k++)o[b[k]]=s[k];j.push(o)}return j}}})})(jQuery);// Modernizr v1.7  www.modernizr.comwindow.Modernizr=function(a,b,c){function G(){e.input=function(a){for(var b=0,c=a.length;b<c;b++)t[a[b]]=!!(a[b]in l);return t}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)l.setAttribute("type",f=a[d]),e=l.type!=="text",e&&(l.value=m,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&l.style.WebkitAppearance!==c?(g.appendChild(l),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,g.removeChild(l)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=l.checkValidity&&l.checkValidity()===!1:/^color$/.test(f)?(g.appendChild(l),g.offsetWidth,e=l.value!=m,g.removeChild(l)):e=l.value!=m)),s[a[d]]=!!e;return s}("search tel url email datetime date month week time datetime-local number range color".split(" "))}function F(a,b){var c=a.charAt(0).toUpperCase()+a.substr(1),d=(a+" "+p.join(c+" ")+c).split(" ");return!!E(d,b)}function E(a,b){for(var d in a)if(k[a[d]]!==c&&(!b||b(a[d],j)))return!0}function D(a,b){return(""+a).indexOf(b)!==-1}function C(a,b){return typeof a===b}function B(a,b){return A(o.join(a+";")+(b||""))}function A(a){k.cssText=a}var d="1.7",e={},f=!0,g=b.documentElement,h=b.head||b.getElementsByTagName("head")[0],i="modernizr",j=b.createElement(i),k=j.style,l=b.createElement("input"),m=":)",n=Object.prototype.toString,o=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),p="Webkit Moz O ms Khtml".split(" "),q={svg:"http://www.w3.org/2000/svg"},r={},s={},t={},u=[],v,w=function(a){var c=b.createElement("style"),d=b.createElement("div"),e;c.textContent=a+"{#modernizr{height:3px}}",h.appendChild(c),d.id="modernizr",g.appendChild(d),e=d.offsetHeight===3,c.parentNode.removeChild(c),d.parentNode.removeChild(d);return!!e},x=function(){function d(d,e){e=e||b.createElement(a[d]||"div");var f=(d="on"+d)in e;f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=C(e[d],"function"),C(e[d],c)||(e[d]=c),e.removeAttribute(d))),e=null;return f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),y=({}).hasOwnProperty,z;C(y,c)||C(y.call,c)?z=function(a,b){return b in a&&C(a.constructor.prototype[b],c)}:z=function(a,b){return y.call(a,b)},r.flexbox=function(){function c(a,b,c,d){a.style.cssText=o.join(b+":"+c+";")+(d||"")}function a(a,b,c,d){b+=":",a.style.cssText=(b+o.join(c+";"+b)).slice(0,-b.length)+(d||"")}var d=b.createElement("div"),e=b.createElement("div");a(d,"display","box","width:42px;padding:0;"),c(e,"box-flex","1","width:10px;"),d.appendChild(e),g.appendChild(d);var f=e.offsetWidth===42;d.removeChild(e),g.removeChild(d);return f},r.canvas=function(){var a=b.createElement("canvas");return a.getContext&&a.getContext("2d")},r.canvastext=function(){return e.canvas&&C(b.createElement("canvas").getContext("2d").fillText,"function")},r.webgl=function(){return!!a.WebGLRenderingContext},r.touch=function(){return"ontouchstart"in a||w("@media ("+o.join("touch-enabled),(")+"modernizr)")},r.geolocation=function(){return!!navigator.geolocation},r.postmessage=function(){return!!a.postMessage},r.websqldatabase=function(){var b=!!a.openDatabase;return b},r.indexedDB=function(){for(var b=-1,c=p.length;++b<c;){var d=p[b].toLowerCase();if(a[d+"_indexedDB"]||a[d+"IndexedDB"])return!0}return!1},r.hashchange=function(){return x("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},r.history=function(){return !!(a.history&&history.pushState)},r.draganddrop=function(){return x("dragstart")&&x("drop")},r.websockets=function(){return"WebSocket"in a},r.rgba=function(){A("background-color:rgba(150,255,150,.5)");return D(k.backgroundColor,"rgba")},r.hsla=function(){A("background-color:hsla(120,40%,100%,.5)");return D(k.backgroundColor,"rgba")||D(k.backgroundColor,"hsla")},r.multiplebgs=function(){A("background:url(//:),url(//:),red url(//:)");return(new RegExp("(url\\s*\\(.*?){3}")).test(k.background)},r.backgroundsize=function(){return F("backgroundSize")},r.borderimage=function(){return F("borderImage")},r.borderradius=function(){return F("borderRadius","",function(a){return D(a,"orderRadius")})},r.boxshadow=function(){return F("boxShadow")},r.textshadow=function(){return b.createElement("div").style.textShadow===""},r.opacity=function(){B("opacity:.55");return/^0.55$/.test(k.opacity)},r.cssanimations=function(){return F("animationName")},r.csscolumns=function(){return F("columnCount")},r.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";A((a+o.join(b+a)+o.join(c+a)).slice(0,-a.length));return D(k.backgroundImage,"gradient")},r.cssreflections=function(){return F("boxReflect")},r.csstransforms=function(){return!!E(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},r.csstransforms3d=function(){var a=!!E(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);a&&"webkitPerspective"in g.style&&(a=w("@media ("+o.join("transform-3d),(")+"modernizr)"));return a},r.csstransitions=function(){return F("transitionProperty")},r.fontface=function(){var a,c,d=h||g,e=b.createElement("style"),f=b.implementation||{hasFeature:function(){return!1}};e.type="text/css",d.insertBefore(e,d.firstChild),a=e.sheet||e.styleSheet;var i=f.hasFeature("CSS2","")?function(b){if(!a||!b)return!1;var c=!1;try{a.insertRule(b,0),c=/src/i.test(a.cssRules[0].cssText),a.deleteRule(a.cssRules.length-1)}catch(d){}return c}:function(b){if(!a||!b)return!1;a.cssText=b;return a.cssText.length!==0&&/src/i.test(a.cssText)&&a.cssText.replace(/\r+|\n+/g,"").indexOf(b.split(" ")[0])===0};c=i('@font-face { font-family: "font"; src: url(data:,); }'),d.removeChild(e);return c},r.video=function(){var a=b.createElement("video"),c=!!a.canPlayType;if(c){c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"');var d='video/mp4; codecs="avc1.42E01E';c.h264=a.canPlayType(d+'"')||a.canPlayType(d+', mp4a.40.2"'),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"')}return c},r.audio=function(){var a=b.createElement("audio"),c=!!a.canPlayType;c&&(c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"'),c.mp3=a.canPlayType("audio/mpeg;"),c.wav=a.canPlayType('audio/wav; codecs="1"'),c.m4a=a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;"));return c},r.localstorage=function(){try{return!!localStorage.getItem}catch(a){return!1}},r.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(a){return!1}},r.webWorkers=function(){return!!a.Worker},r.applicationcache=function(){return!!a.applicationCache},r.svg=function(){return!!b.createElementNS&&!!b.createElementNS(q.svg,"svg").createSVGRect},r.inlinesvg=function(){var a=b.createElement("div");a.innerHTML="<svg/>";return(a.firstChild&&a.firstChild.namespaceURI)==q.svg},r.smil=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"animate")))},r.svgclippaths=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"clipPath")))};for(var H in r)z(r,H)&&(v=H.toLowerCase(),e[v]=r[H](),u.push((e[v]?"":"no-")+v));e.input||G(),e.crosswindowmessaging=e.postmessage,e.historymanagement=e.history,e.addTest=function(a,b){a=a.toLowerCase();if(!e[a]){b=!!b(),g.className+=" "+(b?"":"no-")+a,e[a]=b;return e}},A(""),j=l=null,f&&a.attachEvent&&function(){var a=b.createElement("div");a.innerHTML="<elem></elem>";return a.childNodes.length!==1}()&&function(a,b){function p(a,b){var c=-1,d=a.length,e,f=[];while(++c<d)e=a[c],(b=e.media||b)!="screen"&&f.push(p(e.imports,b),e.cssText);return f.join("")}function o(a){var b=-1;while(++b<e)a.createElement(d[b])}var c="abbr|article|aside|audio|canvas|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",d=c.split("|"),e=d.length,f=new RegExp("(^|\\s)("+c+")","gi"),g=new RegExp("<(/*)("+c+")","gi"),h=new RegExp("(^|[^\\n]*?\\s)("+c+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),i=b.createDocumentFragment(),j=b.documentElement,k=j.firstChild,l=b.createElement("body"),m=b.createElement("style"),n;o(b),o(i),k.insertBefore(m,k.firstChild),m.media="print",a.attachEvent("onbeforeprint",function(){var a=-1,c=p(b.styleSheets,"all"),k=[],o;n=n||b.body;while((o=h.exec(c))!=null)k.push((o[1]+o[2]+o[3]).replace(f,"$1.iepp_$2")+o[4]);m.styleSheet.cssText=k.join("\n");while(++a<e){var q=b.getElementsByTagName(d[a]),r=q.length,s=-1;while(++s<r)q[s].className.indexOf("iepp_")<0&&(q[s].className+=" iepp_"+d[a])}i.appendChild(n),j.appendChild(l),l.className=n.className,l.innerHTML=n.innerHTML.replace(g,"<$1font")}),a.attachEvent("onafterprint",function(){l.innerHTML="",j.removeChild(l),j.appendChild(n),m.styleSheet.cssText=""})}(a,b),e._enableHTML5=f,e._version=d,g.className=g.className.replace(/\bno-js\b/,"")+" js "+u.join(" ");return e}(this,this.document)</script><script>function pad(n, s) {  s = '' + s;  while (s.length < n) { s = ' ' + s; }  return s;}var freq = {};var box = {};var maxfreq = 0;var size = 12;var hslcache = {};var hsl = Modernizr.hsla ? function(seencount, total) {    var hue = seencount / total * 120;    var lightness = 1.0 - total/maxfreq;    return 'hsl(' + hue + ',100%,' + lightness*100 + '%)';  } :  function(seencount, total) {    var key = seencount + '-' + total;    if (hslcache[key]) { return hslcache[key]; }    var hue = seencount / total * 120;    var lightness = 1.0 - total/maxfreq;    var saturation = 1.0;    // http://en.wikipedia.org/wiki/HSL_and_HSV#Converting_to_RGB    var cx = 2*lightness-1;    var c = (1 - (cx >= 0 ? cx : -cx))*saturation;    var h2 = hue / 60;    var h3 = h2 % 2 - 1;    var x = c*(1 - (h3 >= 0 ? h3 : -h3));    var m = lightness - c/2;    if      (h2 <= 1) { return hslcache[key] = 'rgb(' + Math.round(255*(c+m)) + ',' + Math.round(255*(x+m)) + ',' + Math.round(255*(0+m)) + ')'; }    else if (h2 <= 2) { return hslcache[key] = 'rgb(' + Math.round(255*(x+m)) + ',' + Math.round(255*(c+m)) + ',' + Math.round(255*(0+m)) + ')'; }    else if (h2 <= 3) { return hslcache[key] = 'rgb(' + Math.round(255*(0+m)) + ',' + Math.round(255*(c+m)) + ',' + Math.round(255*(x+m)) + ')'; }    else if (h2 <= 4) { return hslcache[key] = 'rgb(' + Math.round(255*(0+m)) + ',' + Math.round(255*(x+m)) + ',' + Math.round(255*(c+m)) + ')'; }    else if (h2 <= 5) { return hslcache[key] = 'rgb(' + Math.round(255*(x+m)) + ',' + Math.round(255*(0+m)) + ',' + Math.round(255*(c+m)) + ')'; }    else if (h2 <= 6) { return hslcache[key] = 'rgb(' + Math.round(255*(c+m)) + ',' + Math.round(255*(0+m)) + ',' + Math.round(255*(x+m)) + ')'; }  };function compute() {  var csv = $.movies;      // Get votes range in logarithmic scale  var votes_min = _.min(csv, function(v) { return +v[3]; })[3],      votes_max = _.max(csv, function(v) { return +v[3]; })[3],      vmin = Math.log(votes_min),      vrange = Math.log(votes_max) - vmin,      // Display inside body, using full width and height, with block size      HEIGHT = 100 * size,  // 100 possible rating values      WIDTH = 100 * size;   // 100 possible rating values  // List seen movies  for (var seenlist={}, i=0, movie; movie=$.seen[i]; i++) {    if (movie.seen) {      var title = $("<a/>").html(movie.title).text();      seenlist[title + ' (' + movie.year + ')'] = 1;    }  }  // Compute freq['x,y'] = [list of movies]  for (var i=0, movie; movie=csv[i]; i++) { (function(movie) {    var x = Math.round((Math.log(movie[3]) - vmin)/vrange*100)*size,        y = Math.round(size*10*(10 - movie[2])),        key = x + ',' + y,        data = freq[key] = (freq[key] || []);    data.push(movie);    if (seenlist[movie[0] + ' (' + movie[1] + ')']) { movie.seen = 1; }    if (data.length > maxfreq) { maxfreq = data.length };  })(movie); }  var $plot = $('#plot').empty();  // Display each block  for (var key in freq) { (function(key) {    var keyparts = key.split(','),        x = +keyparts[0],        y = +keyparts[1],        seencount  = _(freq[key]).filter(function(movie) { return movie.seen }).length,        firstmovie = freq[key][0];    box[key] = $('<a></a>').css({        left:x,        top:y,        backgroundColor: hsl(seencount, freq[key].length)    }).attr({        'class': 'moviebox',        title: _.map(freq[key], function(v) { return pad(3, v[2]) + pad(7, v[3]) + ' '  + v[0] + ' (' + v[1] + ')' + (v.seen ? ' - seen' : ''); }).join('\n'),        href: 'http://www.imdb.com/find?s=all&x=0&y=0&q=' + encodeURIComponent(firstmovie[0] + ' (' + firstmovie[1] + ')'),        target: '_blank'    }).data('key', key).appendTo($plot);    $plot.css({width:WIDTH, height:HEIGHT});    $('#controls,#less-rating,#more-rating').css({width:WIDTH, height:'1.5em'});  })(key); }}// Set up the popupvar $popup = $('<table></table>')    .attr('class', 'popup')    .appendTo('body')    .find('a')      .click(function(e) { e.preventDefault(); })    .end();var popuptemplate = _.template('<% for (var i=0, m; m=movies[i]; i++) { %><tr data-title="<%= m[0] %>" data-year="<%= m[1] %>" class="<%= m.seen ? "seen" : "unseen" %> <%= m[4].match(genre) ? "match" : "nomatch" %>"><td><input type="checkbox" <%= m.seen ? "checked=checked" : "" %>> <a target="_blank" href="http://www.imdb.com/find?s=all&x=0&y=0&q=<%= m[0] + " (" + m[1] + ")" %>"><%= m[0] %></a></td><td><%= m[1] %></td><td><%= m[2] %></td><td><%= m[3] %></td></tr><% } %>');// When a box is clicked, populate and show the popup$('.moviebox').live('click', function(e) {  var $this = $(this);  var movies = freq[$this.data('key')];  var genre = $('#genre').val()  var pos = $this.offset();  $popup    .html(popuptemplate({movies:movies, genre:genre}))    .css({left:pos.left, top:pos.top + size})    .data('key', $this.data('key'))    .show();  e.preventDefault();});// When a movie is marked as seen / unseen, update the box and back-end$('.popup input').live('change', function(e) {  var $this = $(this);  var $row = $this.parents('tr');  var title = $row.attr('data-title');  var year = $row.attr('data-year');  var key = $popup.data('key');  var seen = $this.is(':checked');  for (var i=0, movie; movie=freq[key][i]; i++) {    if ((movie[0] == title) && (movie[1] == year)) { movie.seen = seen; }  }  box[key].css('background-color', hsl($('.popup input:checked').length, freq[key].length));  $this.attr('disabled', true);  $.post('/', {title: title, year: year}, function(response) {    if (response == title) {      $row.attr('class', seen ? 'seen' : 'unseen');    }    $this.attr('disabled', false);  });});// When clicking outside a popup, hide it$('body').live('click', function(e) { var t = $(e.target); if (!t.is('.moviebox') && !t.parents('.popup').length) { $popup.hide(); } });var searchTimeout;function filter() {  if (searchTimeout) { clearTimeout(searchTimeout); }  var title = $('#title').val();  var genre = $('#genre').val();  if ((!title || title.length < 2) && !genre) {    $('#plot').removeClass('searching');    return;  }  var re_title = new RegExp(title, "i");  var re_genre = new RegExp(genre);  searchTimeout = setTimeout(function() {    $('#plot').addClass('searching');    for (var key in freq) {      var moviebox = box[key];      var movies = freq[key];      var found = 0;      var seen = 0;      var allseen = 0;      for (var i=0, movie; movie=movies[i]; i++) {        if (movie[0].match(re_title) &&            movie[4].match(re_genre)) { found += 1; if (movie.seen) { seen += 1; } }        if (movie.seen) { allseen += 1; }      }      if (found) {        moviebox.addClass('found');        moviebox.css('background-color', hsl(seen, found));      } else {        moviebox.removeClass('found');        moviebox.css('background-color', hsl(allseen, freq[key].length));      }    }  }, 200);}$('#title').bind('keyup change', filter);$('#genre').bind('change', filter);var rename = {  'Star Wars: Episode IV - A New Hope': 'Star Wars'};// File format: title, year, rating, votes$.get('/imdb-10000.csv', function(tsvtext) {  $.movies = $.csv("\t")(tsvtext);  $.getJSON('/data/{{ person.email }}/seentitle', function(data) {    $.seen = (data && data.movies) || [];    // Rename the top 250 movies    for (var i=0, movie; movie=$.seen[i]; i++) {      movie.title = $('<b>' + movie.title + '</b>').text();      movie.title = rename[movie.title] || movie.title;    }    compute();  });});</script></body></html>