<!doctype html>
<html><head>
<!-- Google Website Optimizer Control Script -->
<script>function utmx_section(){}function utmx(){}(function(){var k='4014493227',d=document,l=d.location,c=d.cookie;function f(n){if(c){var i=c.indexOf(n+'=');if(i>-1){var j=c.indexOf(';',i);return c.substring(i+n.length+1,j<0?c.length:j)}}}var x=f('__utmx'),xx=f('__utmxx'),h=l.hash;d.write('<sc'+'ript src="'+'http'+(l.protocol=='https:'?'s://ssl':'://www')+'.google-analytics.com'+'/siteopt.js?v=1&utmxkey='+k+'&utmx='+(x?x:'')+'&utmxx='+(xx?xx:'')+'&utmxtime='+new Date().valueOf()+(h?'&utmxhash='+escape(h.substr(1)):'')+'" type="text/javascript" charset="utf-8"></sc'+'ript>')})();</script>
<!-- End of Google Website Optimizer Control Script -->

<title>{% if person %}{% firstof person_info.disp person.nickname %}: {{ person_info.num }} movies on the IMDb Top 250{% else %}Track IMDb Top 250 movies{% endif %}</title>
<meta name="title" content="{% if person %}{% firstof person_info.disp person.nickname %}: {{ person_info.num }} / IMDb Top 250{% else %}Track IMDb Top 250 movies{% endif %}" />
<meta name="description" content="Track movies you've seen on the Internet Movie Database (IMDb) Top 250. Get recommendations. Compare your movie watching with others.">
<link rel="image_src" href="http://i.media-imdb.com/images/nb15/logo2.gif">
<style>
/* 960.gs: reset.css */ html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outline:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}
/* 960.gs: 960.css   */ .container_12,.container_16{margin-left:auto;margin-right:auto;width:960px}.grid_1,.grid_2,.grid_3,.grid_4,.grid_5,.grid_6,.grid_7,.grid_8,.grid_9,.grid_10,.grid_11,.grid_12,.grid_13,.grid_14,.grid_15,.grid_16{display:inline;float:left;margin-left:10px;margin-right:10px}.container_12 .grid_3,.container_16 .grid_4{width:220px}.container_12 .grid_6,.container_16 .grid_8{width:460px}.container_12 .grid_9,.container_16 .grid_12{width:700px}.container_12 .grid_12,.container_16 .grid_16{width:940px}.alpha{margin-left:0}.omega{margin-right:0}.container_12 .grid_1{width:60px}.container_12 .grid_2{width:140px}.container_12 .grid_4{width:300px}.container_12 .grid_5{width:380px}.container_12 .grid_7{width:540px}.container_12 .grid_8{width:620px}.container_12 .grid_10{width:780px}.container_12 .grid_11{width:860px}.container_16 .grid_1{width:40px}.container_16 .grid_2{width:100px}.container_16 .grid_3{width:160px}.container_16 .grid_5{width:280px}.container_16 .grid_6{width:340px}.container_16 .grid_7{width:400px}.container_16 .grid_9{width:520px}.container_16 .grid_10{width:580px}.container_16 .grid_11{width:640px}.container_16 .grid_13{width:760px}.container_16 .grid_14{width:820px}.container_16 .grid_15{width:880px}.container_12 .prefix_3,.container_16 .prefix_4{padding-left:240px}.container_12 .prefix_6,.container_16 .prefix_8{padding-left:480px}.container_12 .prefix_9,.container_16 .prefix_12{padding-left:720px}.container_12 .prefix_1{padding-left:80px}.container_12 .prefix_2{padding-left:160px}.container_12 .prefix_4{padding-left:320px}.container_12 .prefix_5{padding-left:400px}.container_12 .prefix_7{padding-left:560px}.container_12 .prefix_8{padding-left:640px}.container_12 .prefix_10{padding-left:800px}.container_12 .prefix_11{padding-left:880px}.container_16 .prefix_1{padding-left:60px}.container_16 .prefix_2{padding-left:120px}.container_16 .prefix_3{padding-left:180px}.container_16 .prefix_5{padding-left:300px}.container_16 .prefix_6{padding-left:360px}.container_16 .prefix_7{padding-left:420px}.container_16 .prefix_9{padding-left:540px}.container_16 .prefix_10{padding-left:600px}.container_16 .prefix_11{padding-left:660px}.container_16 .prefix_13{padding-left:780px}.container_16 .prefix_14{padding-left:840px}.container_16 .prefix_15{padding-left:900px}.container_12 .suffix_3,.container_16 .suffix_4{padding-right:240px}.container_12 .suffix_6,.container_16 .suffix_8{padding-right:480px}.container_12 .suffix_9,.container_16 .suffix_12{padding-right:720px}.container_12 .suffix_1{padding-right:80px}.container_12 .suffix_2{padding-right:160px}.container_12 .suffix_4{padding-right:320px}.container_12 .suffix_5{padding-right:400px}.container_12 .suffix_7{padding-right:560px}.container_12 .suffix_8{padding-right:640px}.container_12 .suffix_10{padding-right:800px}.container_12 .suffix_11{padding-right:880px}.container_16 .suffix_1{padding-right:60px}.container_16 .suffix_2{padding-right:120px}.container_16 .suffix_3{padding-right:180px}.container_16 .suffix_5{padding-right:300px}.container_16 .suffix_6{padding-right:360px}.container_16 .suffix_7{padding-right:420px}.container_16 .suffix_9{padding-right:540px}.container_16 .suffix_10{padding-right:600px}.container_16 .suffix_11{padding-right:660px}.container_16 .suffix_13{padding-right:780px}.container_16 .suffix_14{padding-right:840px}.container_16 .suffix_15{padding-right:900px}html body * span.clear,html body * div.clear,html body * li.clear,html body * dd.clear{background:none;border:0;clear:both;display:block;float:none;font-size:0;list-style:none;margin:0;padding:0;overflow:hidden;visibility:hidden;width:0;height:0}.clearfix:after{clear:both;content:'.';display:block;visibility:hidden;height:0}.clearfix{display:inline-block}* html .clearfix{height:1%}.clearfix{display:block}
/* 960.gs: text.css modified heavily */
body { font: 13px/1.5 Georgia, 'Times New Roman', serif; }
a:focus { outline: 1px dotted invert; }
p, dl, hr, ol, ul, pre, table, address, fieldset { margin-bottom: 1.5em; }
hr { border-color: #ccc; border-style: solid; border-width: 1px 0 0; clear: both; height: 0; }
h1 { font-size: 25px; }
ol { list-style: decimal; }
ul { list-style: square; }
li { margin-left: 30px; }

/* http://onehub.com/ fix for container to ensure height */
.container_12:after{clear:both;content:'.';display:block;visibility:hidden;height:0}
.container_12{display:inline-block}
* html .container_12{height:1%}
.container_12{display:block}

.blackbar { background-color: black; color: #eeece1; padding: 1.5em 0; }
.blackbar a { color: #eeece1; }
{% if user %}#subheader-bar { display:none; }{% endif %}
h1 a { display:block; text-indent: -1000px; width:304px; height:60px; background: url('/track-top-250.png'); }
.login-box { text-align: center; font: bold 16px sans-serif; width:300px; height:38px; padding: 0; background: url('/login-button.png'); }
.login { display:block; padding-top: 10px; text-decoration: none; }
input, textarea { background-color: #9bbb59; }

.mainbar h2 { font: bold 16px Geneva, Arial, sans-serif; margin-bottom: 0.5em; border-bottom: 5px solid #4f6228; color: #4f6228; }
.mainbar a { color: #4f6228; }
.mainbar .stats { font-style: italic; font-size: 12px; }
.mainbar .diff, .mainbar .follow, .mainbar .unfollow { text-decoration: none; color: #da1f28; font: bold 11px Geneva,Arial,sans-serif; }
.mainbar .follow, .mainbar .unfollow  { color: #0000ff; }

.movies { width: 100%; }
.movies td, .movies th { height: 22px; vertical-align: middle; }
.movies th { text-align: left; padding: 0 3px; font-weight: normal; }
.movies th { background-color: #bbe06a; border: 1px solid #9bbb59; border-left: 2px outset #bbe06a; cursor: pointer; font-weight: bold;
	background-image: -moz-linear-gradient    (left top, left bottom, from(#bbe06a), to(#9bbb59));
	background-image: -webkit-gradient(linear, left top, left bottom, from(#bbe06a), to(#9bbb59));
}

.instructions { color: #4f6228; font-style: italic; }
#filter { float:right; border: 1px solid #4f6228; border-width: 1px 0 0 1px; }
#following td, #top_watchers td, #recent_watchers td { padding-right: 1em; }

.ic { display:inline-block; width: 16px; height: 16px; margin-right: 5px; background-image: url(/favicons.png); overflow: hidden; vertical-align: middle; }
.im, .netflix, .lovefilm { float:right; }
.im { background-position: 0 -16px; }
.netflix { background-position: 0 0; }
.lovefilm { background-position: -16px 0; }
.twitter { background-position: -32px 0; }
.facebook { background-position: -32px -16px; }
.rss { background-position: -16px -16px;}

.seen, .seen a { text-decoration: line-through; color: #c3d69b; }
.person { color:#4f6228; }
.both { color: #ddd; font-style: normal; }
.other { color: #da1f28; font-style: italic; }
.neither { color: #ddd; }

.bottombar h2 { font-size: 23px; margin-bottom: 0.5em; }
.source { font-size: 11px; width:100%; display:block; }
.widget-name { color: #9bbb59; font-weight: bold; }
.share_link { font: 11px Tahoma, sans-serif; }

/* http://www.hedgerwow.com/360/dhtml/css-round-button/demo.php */
a.button,span.button,del.button,a.button span,span.button button,span.button input,del.button span{background-image:url(/button-light-green.png);_background-image:url(/button-light-green.gif);}
a.button,span.button,del.button{display:-moz-inline-box;display:inline-block;cursor:pointer;border:none;font-size:0;line-height:0;background-position:0 0;background-repeat:no-repeat;height:30px;text-decoration:none;color:#fff;font-style:normal;margin:0 6px 0 0;padding:0 10px 0 0;vertical-align:middle;padding-top:-2px;_position:relative;_width:10px;_overflow-y:hidden;}
a.button span,span.button button,span.button input,del.button span{white-space:nowrap;cursor:pointer;color:#fff;display:-moz-inline-box;display:inline-block;line-height:1;letter-spacing:0!important;font:bold 14px sans-serif;background-color:transparent;background-position:100% 0;background-repeat:no-repeat;height:30px;padding:8px 20px 0 10px;margin:0 -20px 0 10px;border:none;vertical-align:text-top;zoom:1;_position:relative;_padding-left:0;_padding-right:12px;_margin-right:-16px;_display:block;_top:0;_right:-5px;}span.button button{line-height:2.5;}html.safari a.button span,html.safari del.button span{line-height:1.3;}html.safari span.button button{line-height:2.6;}html.safari a.button:focus,html.safari span.button button:focus{outline:none;}del.button{background-position:0 -120px;}del.button span{cursor:default;color:#aaa!important;background-position:100% -120px;}span.button button,span.button input{padding-top:0;line-height:2.5;}a.button:hover,span.button:hover,a.button:focus,a.dom-button-focus,span.button-behavior-hover{background-position:0 -60px;color:#222;text-decoration:none;}a.button:hover span,span.button:hover button,a.button:focus span,span.button-behavior-hover button,span.button-behavior-hover input{background-position:100% -60px;}a.button:active,a.button:focus span{color:#444;}del.button-behavior-hover,del.button:hover{background-position:0 -180px;}del.button-behavior-hover span,del.button:hover span{background-position:100% -180px;}span.button button,del.button span,span.button input{_behavior:expression((function(e){if(typeof(behavior_onMouseEnter)=='undefined'){behavior_onMouseEnter=function(e){var d=this.parentNode;var c=d.className;d.__defaultClassName=c;d.className=c+' button-behavior-hover';this.setCapture();};behavior_onMouseLeave=function(e){var d=this.parentNode;d.className=d.__defaultClassName;d.__defaultClassName=undefined;this.releaseCapture();};};e.runtimeStyle.behavior='none';e.onmouseenter=behavior_onMouseEnter;e.onmouseleave=behavior_onMouseLeave;})(this));}
</style>
</head><body>
<div class="blackbar">
	<div class="container_12">
		<div id="header-bar" class="grid_12">
			<div id="heading-box" class="alpha grid_8"><h1><a href="/">Track the IMDb Top 250</a></h1></div>
			<div class="omega grid_4 login-box"><div class="login-button">
				{% if user %}<a class="login" href="#">{% firstof user_info.disp user.nickname %} (<span class="user-seen-count">{{ user_info.num }}</span>)</a>
				{% else %}<a class="login" href="/login">Sign in with your Google Account</a>
				{% endif %}
			</div></div>
		</div>
		<div id="subheader-bar" class="grid_12">
			<div class="alpha grid_8"><i>This application lets you mark movies that you have seen on the IMDb Top 250.<br>You can see which movies you've missed out, and compare your movie watching with others.</i></div>
			<div class="omega grid_4" style="text-align:right">
			{% if user %}
				<form id="userprefs" action="/" method="post">
					<input id="disp" name="disp" value="{% firstof user_info.disp user.nickname %}">
					<input type="submit" value="Change name">
				</form>
				or <a id="logout" href="/logout">click here to logout</a>
			{% else %}
				<i>If you don't have a Google Account,<br>click the button above to create one.</i>
			{% endif %}
			</div>
		</div>
	</div>
</div>

<div class="clear">&nbsp;</div>
<div class="container_12 mainbar">
	<div class="grid_8">
	{% if can_change and new_movies %}
		<h2>New in the IMDb Top 250</h2>
		<table id="newmovies" class="sortable movies"><thead>
			<tr><th>Rank</th><th>Year</th><th>Movie</th><th>Rating</th><th>Votes</th></tr>
		</thead><tbody>
{% for movie in new_movies %}
<tr class="{% if movie.person and movie.other %}both {% else %}{% if movie.person %}person {% else %}{% if movie.other %}other {% else %}{% if other %}neither {% endif %}{% endif %}{% endif %}{% endif %}{% if movie.seen %}seen {% else %}unseen {% endif %}movie"><td>{{ movie.rank }}
</td><td>{{ movie.year }}
</td><td><a class="ic im" href="http://www.imdb.com{{ movie.url }}"></a>
{% if can_change %}<a>{{ movie.title }}</a>{% else %}{{ movie.title }}{% endif %}
</td><td>{{ movie.rating }}
</td><td>{{ movie.votes }}
</td></tr>
{% endfor %}
		</tbody></table>
	{% endif %}
		<h2>
		{% if person %}
			<select id="filter">
				<option value="all" 			>All movies</option>
				{% if other %}
				<option value="person_not_other">Seen only by {% firstof person_info.disp person.nickname %} NOT {% firstof other_info.disp other.nickname %}</option>
				<option value="other_not_person">Seen only by {% firstof other_info.disp other.nickname %} NOT {% firstof person_info.disp person.nickname %}</option>
				<option value="both"			>Seen by Both</option>
				<option value="either"			>Seen by Either</option>
				<option value="neither" 		>Seen by Neither</option>
				<option value="person"			>Seen by {% firstof person_info.disp person.nickname %}</option>
				<option value="other"			>Seen by {% firstof other_info.disp other.nickname %}</option>
				{% else %}
				<option value="unseen"			>Show only unseen movies</option>
				<option value="seen"			>Show only seen   movies</option>
				{% endif %}
			</select>
		{% endif %}
		{% if person %}<span class="person">{% firstof person_info.disp person.nickname %}: <span class="user-seen-count">{{ person_info.num }}</span> / 250</span>
			{% if other %}vs <span class="other">{% firstof other_info.disp other_info.user.nickname %}: {{ other_info.num }} / 250</span>
			{% else %}
				{% if user %}{% ifnotequal user person %}
					<a class="diff" href="/compare/{% firstof person_info.disp person_info.user.email %}">diff</a>
					{% if not person_info.follower %}<a class="follow" href="/follow/{{ person_info.user.email }}">follow</a>
					{% else %}<a class="unfollow" href="/unfollow/{{ person_info.user.email }}">unfollow</a>{% endif %}
				{% endifnotequal %}{% endif %}
			{% endif %}
		{% else %}IMDb Top 250
		{% endif %}
		</h2>
		{% if can_change %}<div class="instructions">Click on a movie to mark it as <span class="seen">seen</span>. Click again to toggle.</div>{% endif %}
		<table id="movies" class="sortable movies"><thead>
		<tr><th>Rank</th><th>Year</th><th>Movie</th><th>Rating</th><th>Votes</th></tr>
		</thead><tbody>
{% for movie in movies %}
<tr class="{% if movie.person and movie.other %}both {% else %}{% if movie.person %}person {% else %}{% if movie.other %}other {% else %}{% if other %}neither {% endif %}{% endif %}{% endif %}{% endif %}{% if movie.seen %}seen {% else %}unseen {% endif %}movie"><td>{{ movie.rank }}
</td><td>{{ movie.year }}
</td><td><a class="ic im" href="http://www.imdb.com{{ movie.url }}"></a><a>{{ movie.title }}</a>
</td><td>{{ movie.rating }}
</td><td>{{ movie.votes }}
</td></tr>
{% endfor %}
		</tbody></table>
	</div>
	<div class="grid_4">
		{% if person_info %}
		<h2>Share this page</h2>
		<p>
			<script>utmx_section("SharingLinks")</script>
			<a class="share_twitter" target="_blank" href="http://twitter.com/home"><b class="ic twitter"></b> Share on Twitter</a>
			<br><a class="share_facebook" target="_blank" href="http://www.facebook.com/sharer.php"><b class="ic facebook"></b> Share on Facebook</a>
			</noscript>
		</p>
		<p>Link: <a class="share_link" target="_blank" href="http://250.s-anand.net{% if person_info.disp %}/name/{{ person_info.disp|urlencode }}{% else %}/user/{{ person_info.user.email }}{% endif %}">250.s-anand.net{% if person_info.disp %}/name/{{ person_info.disp }}{% else %}/user/{{ person_info.user.email }}{% endif %}</a>		{% endif %}</p>
		{% if person_recos %}
		<h2>Recommendations for {% firstof person_info.disp person.nickname %}</h2>
		Based on people with similar interests.
		<ol id="person_recos">
		{% for movie in person_recos %}
			<li><a target="_blank" href="http://www.imdb.com{{ movie.url }}">{{ movie.title }}</a></li>
		{% endfor %}
		</ol>
		{% endif %}

		{% if user_followers and can_change %}
		<h2>{% firstof user_info.disp user.nickname %} is following</h2>
		<table id="following">
		{% for x in user_followers %}
			<tr><td>{{ x.num }}</td><td>
			{% if x.disp %}<a href="/name/{{ x.disp|urlencode }}">{{ x.disp }}</a>{% else %}<a href="/user/{{ x.user.email }}">{{ x.user.nickname }}</a>{% endif %}
			{% if user %}{% ifnotequal user x.user %}
				<a href="/compare/{% firstof x.disp x.user.email %}" class="diff">diff</a>
				<a class="unfollow" href="/unfollow/{{ x.user.email }}">unfollow</a>
			{% endifnotequal %}{% endif %}
			</td></tr>
		{% endfor %}
		</table>
		{% endif %}

		<h2>Top movie watchers</h2>
		<table id="top_watchers">
		{% for x in top_watchers %}
			<tr><td>{{ x.num }}</td><td>{% if x.disp %}<a href="/name/{{ x.disp|urlencode }}">{{ x.disp }}</a>{% else %}<a href="/user/{{ x.user.email }}">{{ x.user.nickname }}</a>{% endif %}
			{% if user %}{% ifnotequal user x.user %}
				<a href="/compare/{% firstof x.disp x.user.email %}" class="diff">diff</a>
				{% if not x.follower %}<a class="follow" href="/follow/{{ x.user.email }}">follow</a>{% endif %}
			{% endifnotequal %}{% endif %}
			</td></tr>
		{% endfor %}
		</table>

		<h2>Recent movie watchers</h2>
		<table id="recent_watchers">
		{% for x in recent_users %}
			<tr><td>{{ x.num }}</td><td>{% if x.disp %}<a href="/name/{{ x.disp|urlencode }}">{{ x.disp }}</a>{% else %}<a href="/user/{{ x.user.email }}">{{ x.user.nickname }}</a>{% endif %}
			{% if user %}{% ifnotequal user x.user %}
				<a href="/compare/{% firstof x.disp x.user.email %}" class="diff">diff</a>
				{% if not x.follower %}<a class="follow" href="/follow/{{ x.user.email }}">follow</a>{% endif %}
			{% endifnotequal %}{% endif %}
			<span class="stats">{{ now|timesince:x.time }} ago </span>
		{% endfor %}
		</table>
	</div>
</div>
<div class="clear">&nbsp;</div>
<div class="blackbar bottombar">
	<div class="container_12">
		<div class="grid_6">
			<h2>API</h2>
			<p><a href="/data/root.node@gmail.com/count"><code>/data/<i>user</i>/count</code></a> returns the user's watched count
			<br><a href="/data/root.node@gmail.com/seen"><code>/data/<i>user</i>/seen</code></a> returns the user's seen / unseen movies
			<br><code>/data/all/users</code> is an <i>Admin</i> API that shows all users</p>
			<p>Results in returned in JSON, with <code>callback</code> support.
			<br>e.g. <a href="/data/root.node@gmail.com/count?callback=fn"><code>/data/<i>user</i>/count?callback=fn</code></a>.</p>
			<p><a type="application/rss+xml" rel="alternate" class="ic rss" href="http://feeds.s-anand.net/imdbtop250"></a> <a href="http://feeds.s-anand.net/imdbtop250">Subscribe to the IMDb Top 250</a></p>
			<p>This page is hosted by <a href="http://appengine.google.com/">Google AppEngine</a><br>The source code is at <a href="http://two-fifty.googlecode.com/">two-fifty.googlecode.com</a></p>
			<p>Authored by <a href="http://www.s-anand.net/">Anand</a></p>
			<p>Alternatives: <a href="http://www.icheckmovies.com/">icheckmovies.com</a> | <a href="http://www.250films.net/">250films.net</a></p>
		</div>
		<div class="grid_6">
		{% if user %}
			<h2>Widgets</h2>
			<textarea class="source" readonly>&lt;script src="http://250.s-anand.net/count.js"&gt;&lt;/script&gt;&lt;script src="http://250.s-anand.net/data/{{ person.email }}/count?callback=twofifty_count"&gt;&lt;/script&gt;</textarea>
			<p>Copy and paste the code above to add the <span class="widget-name">Movie Counter</span> widget to your website. It shows visitors the number of movies you've watched.</p>
			<textarea class="source" readonly>&lt;script src="http://250.s-anand.net/seen.js"&gt;&lt;/script&gt;&lt;script src="http://250.s-anand.net/data/{{ person.email }}/seen?callback=twofifty_seen"&gt;&lt;/script&gt;</textarea>
			<p>Copy and paste the code above to add the <span class="widget-name">Recent Movies</span> widget to your website. It shows the last 5 movies you watched on IMDb.</p>
		{% else %}
			<div class="login-box"><div class="login-button">
			<a class="login" href="/login">Sign in to add widgets to your site</a>
			</div></div>
		</div>
		{% endif %}
	</div>
</div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
<script>
try { document.execCommand("BackgroundImageCache", false, fix); } catch(err) { }

{% if can_change %}
$('.movie a:not([href])')
	.attr('href', '#')
	.attr('class', 'x')
	.each(function() {
		$(this).attr('data', $(this).prev().attr('href').replace('http://www.imdb.com', ''));
	});
{% endif %}
{% if not user and not person %}
$('.movie a:not([href])').attr('href', '/login');
{% endif %}
$('.movies tbody tr:odd').css('background-color', '#ebf8de');
$('.movies a.im').attr('target', '_blank').attr('title', 'Open IMDb page in new window');
$('a.diff').attr('title', 'Compare with yourself');
$('.source').click(function() { $(this).select(); });

$('.share_twitter').attr('href', "http://twitter.com/home?status={% firstof person_info.disp person.nickname %} has seen {{ person_info.num }} of the @IMDb Top 250 movies. http://250.s-anand.net{% if person_info.disp %}/name/{{ person_info.disp|urlencode|urlencode }}{% else %}/user/{{ person_info.user.email }}{% endif %}");
$('.share_facebook').attr('href', "http://www.facebook.com/sharer.php?u=http://250.s-anand.net{% if person_info.disp %}/name/{{ person_info.disp|urlencode }}{% else %}/user/{{ person_info.user.email }}{% endif %}&t=Track movies you've seen on the IMDb Top 250");

var actions = [
{	url:	'http://www.netflix.com/Search?v1=%s',
	title:	'Search and rent on Netflix',
	cls:	'netflix'
},
{	url:	'http://www.lovefilm.com/search/overview.html?search_keywords=%s',
	title:	'Search and rent on LoveFilm',
	cls:	'lovefilm'
}
];

$('.movies tr').find('td:eq(2)').each(function() {
	for (var i=0, a; a=actions[i]; i++) {
		$(this).prepend('<a target="_blank" title="$title" class="ic $cls" href="$url"></a> '
			.replace('$url',	a.url.replace('%s', $(this).text()))
			.replace('$title',	a.title)
			.replace('$pos',	a.pos)
			.replace('$cls',	a.cls)
		);
	}
});

$('#filter').change(function(e) {
	switch($(this).find('option:selected').attr('value')) {
		case 'all': 				$('.movies tr').show(); break;
		case 'seen':				$('.movies tr.seen').show(); $('.movies tr.unseen').hide(); break;
		case 'unseen':				$('.movies tr.unseen').show(); $('.movies tr.seen').hide(); break;
		case 'person':				$('.movies tr.person,tr.both').show(); $('.movies tr.other,tr.neither').hide(); break;
		case 'other':				$('.movies tr.other,tr.both').show(); $('.movies tr.person,tr.neither').hide(); break;
		case 'both':				$('.movies tr.both').show(); $('.movies tr.person,tr.other,tr.neither').hide(); break;
		case 'either':				$('.movies tr.person,tr.other,tr.both').show(); $('.movies tr.neither').hide(); break;
		case 'neither': 			$('.movies tr.neither').show(); $('.movies tr.person,tr.other,tr.both').hide(); break;
		case 'person_not_other':	$('.movies tr.person').show(); $('.movies tr.both,tr.other,tr.neither').hide(); break;
		case 'other_not_person':	$('.movies tr.other').show(); $('.movies tr.both,tr.person,tr.neither').hide(); break;
	}
});

{% if user %}$('.login').click(function(e) { e.preventDefault(); $('#subheader-bar').slideToggle(); });{% endif %}

{% if can_change %}
$('.movies a.x').attr('title', 'Click to mark as seen or unseen').click(function(e) {
	e.preventDefault();
	var url = $(e.target).attr('data'),
		tgt = $('.movies a.x[data=' + url + ']');
	tgt.parent().append('<img src="/loading-small.gif" alt="working..." class="working">');
	$.post('/', {movie: url}, function(response) {
		if (response == url) {
			var tr = tgt.parents('tr'),
				sc = $('.user-seen-count'),
				n  = +sc.eq(0).text();
			if		(tr.hasClass('seen'  )) { tr.addClass('unseen').removeClass('seen'	); n--; }
			else if (tr.hasClass('unseen')) { tr.addClass('seen'  ).removeClass('unseen'); n++; }
			sc.text(n);
			tr.find('.working').remove();
			$('#count').text($('tr.seen').length);
		}
	});
});
{% endif %}

</script>


<script>
/* sorttable.js */var stIsIE=false;sorttable={init:function(){if(arguments.callee.done)return;arguments.callee.done=true;if(_timer)clearInterval(_timer);if(!document.createElement||!document.getElementsByTagName)return;sorttable.DATE_RE=/^(\d\d?)[\/\.-](\d\d?)[\/\.-]((\d\d)?\d\d)$/;forEach(document.getElementsByTagName('table'),function(table){if(table.className.search(/\bsortable\b/)!=-1){sorttable.makeSortable(table);}});},makeSortable:function(table){if(table.getElementsByTagName('thead').length==0){the=document.createElement('thead');the.appendChild(table.rows[0]);table.insertBefore(the,table.firstChild);}
if(table.tHead==null)table.tHead=table.getElementsByTagName('thead')[0];if(table.tHead.rows.length!=1)return;sortbottomrows=[];for(var i=0;i<table.rows.length;i++){if(table.rows[i].className.search(/\bsortbottom\b/)!=-1){sortbottomrows[sortbottomrows.length]=table.rows[i];}}
if(sortbottomrows){if(table.tFoot==null){tfo=document.createElement('tfoot');table.appendChild(tfo);}
for(var i=0;i<sortbottomrows.length;i++){tfo.appendChild(sortbottomrows[i]);}
delete sortbottomrows;}
headrow=table.tHead.rows[0].cells;for(var i=0;i<headrow.length;i++){if(!headrow[i].className.match(/\bsorttable_nosort\b/)){mtch=headrow[i].className.match(/\bsorttable_([a-z0-9]+)\b/);if(mtch){override=mtch[1];}
if(mtch&&typeof sorttable["sort_"+override]=='function'){headrow[i].sorttable_sortfunction=sorttable["sort_"+override];}else{headrow[i].sorttable_sortfunction=sorttable.guessType(table,i);}
headrow[i].sorttable_columnindex=i;headrow[i].sorttable_tbody=table.tBodies[0];dean_addEvent(headrow[i],"click",function(e){if(this.className.search(/\bsorttable_sorted\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace('sorttable_sorted','sorttable_sorted_reverse');this.removeChild(document.getElementById('sorttable_sortfwdind'));sortrevind=document.createElement('span');sortrevind.id="sorttable_sortrevind";sortrevind.innerHTML=stIsIE?'&nbsp<font face="webdings">5</font>':'&nbsp;&#x25B4;';this.appendChild(sortrevind);return;}
if(this.className.search(/\bsorttable_sorted_reverse\b/)!=-1){sorttable.reverse(this.sorttable_tbody);this.className=this.className.replace('sorttable_sorted_reverse','sorttable_sorted');this.removeChild(document.getElementById('sorttable_sortrevind'));sortfwdind=document.createElement('span');sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':'&nbsp;&#x25BE;';this.appendChild(sortfwdind);return;}
theadrow=this.parentNode;forEach(theadrow.childNodes,function(cell){if(cell.nodeType==1){cell.className=cell.className.replace('sorttable_sorted_reverse','');cell.className=cell.className.replace('sorttable_sorted','');}});sortfwdind=document.getElementById('sorttable_sortfwdind');if(sortfwdind){sortfwdind.parentNode.removeChild(sortfwdind);}
sortrevind=document.getElementById('sorttable_sortrevind');if(sortrevind){sortrevind.parentNode.removeChild(sortrevind);}
this.className+=' sorttable_sorted';sortfwdind=document.createElement('span');sortfwdind.id="sorttable_sortfwdind";sortfwdind.innerHTML=stIsIE?'&nbsp<font face="webdings">6</font>':'&nbsp;&#x25BE;';this.appendChild(sortfwdind);row_array=[];col=this.sorttable_columnindex;rows=this.sorttable_tbody.rows;for(var j=0;j<rows.length;j++){row_array[row_array.length]=[sorttable.getInnerText(rows[j].cells[col]),rows[j]];}
row_array.sort(this.sorttable_sortfunction);tb=this.sorttable_tbody;for(var j=0;j<row_array.length;j++){tb.appendChild(row_array[j][1]);}
delete row_array;});}}},guessType:function(table,column){sortfn=sorttable.sort_alpha;for(var i=0;i<table.tBodies[0].rows.length;i++){text=sorttable.getInnerText(table.tBodies[0].rows[i].cells[column]);if(text!=''){if(text.match(/^-?[$]?[\d,.]+%?$/)){return sorttable.sort_numeric;}
possdate=text.match(sorttable.DATE_RE)
if(possdate){first=parseInt(possdate[1]);second=parseInt(possdate[2]);if(first>12){return sorttable.sort_ddmm;}else if(second>12){return sorttable.sort_mmdd;}else{sortfn=sorttable.sort_ddmm;}}}}
return sortfn;},getInnerText:function(node){hasInputs=(typeof node.getElementsByTagName=='function')&&node.getElementsByTagName('input').length;if(node.getAttribute("sorttable_customkey")!=null){return node.getAttribute("sorttable_customkey");}
else if(typeof node.textContent!='undefined'&&!hasInputs){return node.textContent.replace(/^\s+|\s+$/g,'');}
else if(typeof node.innerText!='undefined'&&!hasInputs){return node.innerText.replace(/^\s+|\s+$/g,'');}
else if(typeof node.text!='undefined'&&!hasInputs){return node.text.replace(/^\s+|\s+$/g,'');}
else{switch(node.nodeType){case 3:if(node.nodeName.toLowerCase()=='input'){return node.value.replace(/^\s+|\s+$/g,'');}
case 4:return node.nodeValue.replace(/^\s+|\s+$/g,'');break;case 1:case 11:var innerText='';for(var i=0;i<node.childNodes.length;i++){innerText+=sorttable.getInnerText(node.childNodes[i]);}
return innerText.replace(/^\s+|\s+$/g,'');break;default:return'';}}},reverse:function(tbody){newrows=[];for(var i=0;i<tbody.rows.length;i++){newrows[newrows.length]=tbody.rows[i];}
for(var i=newrows.length-1;i>=0;i--){tbody.appendChild(newrows[i]);}
delete newrows;},sort_numeric:function(a,b){aa=parseFloat(a[0].replace(/[^0-9.-]/g,''));if(isNaN(aa))aa=0;bb=parseFloat(b[0].replace(/[^0-9.-]/g,''));if(isNaN(bb))bb=0;return aa-bb;},sort_alpha:function(a,b){if(a[0]==b[0])return 0;if(a[0]<b[0])return-1;return 1;},sort_ddmm:function(a,b){mtch=a[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1)m='0'+m;if(d.length==1)d='0'+d;dt1=y+m+d;mtch=b[0].match(sorttable.DATE_RE);y=mtch[3];m=mtch[2];d=mtch[1];if(m.length==1)m='0'+m;if(d.length==1)d='0'+d;dt2=y+m+d;if(dt1==dt2)return 0;if(dt1<dt2)return-1;return 1;},sort_mmdd:function(a,b){mtch=a[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1)m='0'+m;if(d.length==1)d='0'+d;dt1=y+m+d;mtch=b[0].match(sorttable.DATE_RE);y=mtch[3];d=mtch[2];m=mtch[1];if(m.length==1)m='0'+m;if(d.length==1)d='0'+d;dt2=y+m+d;if(dt1==dt2)return 0;if(dt1<dt2)return-1;return 1;},shaker_sort:function(list,comp_func){var b=0;var t=list.length-1;var swap=true;while(swap){swap=false;for(var i=b;i<t;++i){if(comp_func(list[i],list[i+1])>0){var q=list[i];list[i]=list[i+1];list[i+1]=q;swap=true;}}
t--;if(!swap)break;for(var i=t;i>b;--i){if(comp_func(list[i],list[i-1])<0){var q=list[i];list[i]=list[i-1];list[i-1]=q;swap=true;}}
b++;}}}
if(document.addEventListener){document.addEventListener("DOMContentLoaded",sorttable.init,false);}
if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){sorttable.init();}},10);}
window.onload=sorttable.init;function dean_addEvent(element,type,handler){if(element.addEventListener){element.addEventListener(type,handler,false);}else{if(!handler.$$guid)handler.$$guid=dean_addEvent.guid++;if(!element.events)element.events={};var handlers=element.events[type];if(!handlers){handlers=element.events[type]={};if(element["on"+type]){handlers[0]=element["on"+type];}}
handlers[handler.$$guid]=handler;element["on"+type]=handleEvent;}};dean_addEvent.guid=1;function removeEvent(element,type,handler){if(element.removeEventListener){element.removeEventListener(type,handler,false);}else{if(element.events&&element.events[type]){delete element.events[type][handler.$$guid];}}};function handleEvent(event){var returnValue=true;event=event||fixEvent(((this.ownerDocument||this.document||this).parentWindow||window).event);var handlers=this.events[event.type];for(var i in handlers){this.$$handleEvent=handlers[i];if(this.$$handleEvent(event)===false){returnValue=false;}}
return returnValue;};function fixEvent(event){event.preventDefault=fixEvent.preventDefault;event.stopPropagation=fixEvent.stopPropagation;return event;};fixEvent.preventDefault=function(){this.returnValue=false;};fixEvent.stopPropagation=function(){this.cancelBubble=true;}
if(!Array.forEach){Array.forEach=function(array,block,context){for(var i=0;i<array.length;i++){block.call(context,array[i],i,array);}};}
Function.prototype.forEach=function(object,block,context){for(var key in object){if(typeof this.prototype[key]=="undefined"){block.call(context,object[key],key,object);}}};String.forEach=function(string,block,context){Array.forEach(string.split(""),function(chr,index){block.call(context,chr,index,string);});};var forEach=function(object,block,context){if(object){var resolve=Object;if(object instanceof Function){resolve=Function;}else if(object.forEach instanceof Function){object.forEach(block,context);return;}else if(typeof object=="string"){resolve=String;}else if(typeof object.length=="number"){resolve=Array;}
resolve.forEach(object,block,context);}};
</script>

<!-- Google Website Optimizer Tracking Script -->
<script type="text/javascript">if(typeof(_gat)!='object')document.write('<sc'+'ript src="http'+(document.location.protocol=='https:'?'s://ssl':'://www')+'.google-analytics.com/ga.js"></sc'+'ript>')</script>
<script type="text/javascript">try {var gwoTracker=_gat._getTracker("UA-7021987-1");gwoTracker._trackPageview("/4014493227/test");}catch(err){}</script>
<!-- End of Google Website Optimizer Tracking Script -->

<script>
var pageTracker = _gat._getTracker("UA-7269195-1");
pageTracker._trackPageview();
{% if user %}pageTracker._setCustomVar(1,"HasLoggedIn","Yes",1);{% endif %}
{% if not user %}
$('a[href*=login]'		).click(function()	{ pageTracker._trackPageview('/login'); 						});{% endif %}
$('a.x' 				).click(function()	{ pageTracker._trackPageview('/clicked/movie'); 				});
$('a.follow'			).click(function()	{ pageTracker._trackPageview('/clicked/follow');				});
$('a.unfollow'			).click(function()	{ pageTracker._trackPageview('/clicked/unfollow');				});
$('#filter' 			).change(function()	{ pageTracker._trackPageview('/clicked/filter');				});
$('a[class^=share],a.ic').click(function()	{ pageTracker._trackPageview('/clicked/'+$(this).attr('class'));});
</script>

<!-- Google Website Optimizer Conversion Script -->
<script type="text/javascript">
$('.share_twitter,.share_facebook,.share_link').click(function() {
	try {var gwoTracker=_gat._getTracker("UA-7021987-1");gwoTracker._trackPageview("/4014493227/goal");}catch(err){}
});
</script>
<!-- End of Google Website Optimizer Conversion Script -->

<!-- script type="text/javascript">try { setTimeout(function() { $.getScript('/build-reco.js'); }, 5000); } catch(err) {}</script -->
<!-- script src="http://asset.userfly.com/users/12427/userfly.js" type="text/javascript"></script -->

<style type='text/css'>@import url('http://s3.amazonaws.com/getsatisfaction.com/feedback/feedback.css');</style>
<script src='http://s3.amazonaws.com/getsatisfaction.com/feedback/feedback.js' type='text/javascript'></script>
<script>GSFN.feedback('http://getsatisfaction.com/twofifty/feedback/topics/new?display=overlay&style=idea', {'placement': 'left', 'color': '#222'});</script>
</body></html>
